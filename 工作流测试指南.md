# 🧪 工作流测试指南

## 📋 测试环境说明

我根据您的工作流配置创建了一个完整的测试demo：`demo-test-page.html`

这个demo模拟了一个提报系统，包含了您工作流中的所有关键元素。

## 🎯 工作流配置对应关系

### 1. 循环操作 (Loop)
- **配置**: `.core-table .core-table-body .core-table-tr .core-table-td .pulse-button`
- **说明**: 循环点击表格中的"提报"按钮
- **测试**: 页面中有多个提报按钮，工作流会依次点击

### 2. 智能等待 (Smart Wait)
- **配置**: 
  - 定位策略: ID
  - 定位值: `test1`
  - 属性名称: `class`
  - 比较方式: 包含
  - 期望值: `loaded`
- **说明**: 等待特定元素的class属性包含"loaded"
- **测试**: 点击提报按钮后，等待抽屉显示

### 3. 点击操作 (Click)
- **配置**: `.core-drawer-footer .pulse-drawer-footer .space-x-12 button:nth-of-type(1)`
- **说明**: 点击抽屉中的"选择商品"按钮
- **测试**: 抽屉显示后，点击第一个按钮

### 4. 敏感词检测
- **配置**: 
  - 敏感词: `rally`
  - 检测元素: `.text-neutral-text1`
- **说明**: 跳过包含"rally"的项目
- **测试**: 表格中的"Rally项目"会被跳过

## 🚀 测试步骤

### 步骤1: 打开测试页面
```bash
# 在浏览器中打开
file:///G:/tok/tk-zidongtibao/demo-test-page.html
```

### 步骤2: 在工作流设计器中配置测试
1. 打开工作流设计器
2. 点击智能等待步骤的"测试"按钮
3. 选择demo测试页面
4. 查看测试结果

### 步骤3: 测试各个功能

#### 🔄 循环操作测试
```
定位策略: CSS选择器
定位值: .core-table .core-table-body .core-table-tr .core-table-td .pulse-button
```

#### ⏳ 智能等待测试
```
定位策略: ID
定位值: test1
属性名称: class
比较方式: 包含
期望值: loaded
```

#### 🖱️ 点击操作测试
```
定位策略: CSS选择器
定位值: .core-drawer-footer .pulse-drawer-footer .space-x-12 button:nth-of-type(1)
```

#### 🚫 敏感词检测测试
```
敏感词: rally
检测元素: .text-neutral-text1
```

## 📊 测试场景

### 场景1: 正常流程
1. 循环点击提报按钮
2. 等待抽屉显示
3. 点击选择商品
4. 等待商品弹窗显示

### 场景2: 敏感词过滤
1. 添加Rally项目（包含敏感词）
2. 循环操作会跳过这些项目
3. 只处理正常项目

### 场景3: 虚拟列表滚动
1. 页面会自动模拟滚动
2. 动态添加新项目
3. 测试虚拟列表处理

## 🎮 页面控制功能

### 数据控制
- **添加正常项目**: 添加普通的提报项目
- **添加Rally项目**: 添加包含敏感词的项目
- **清空所有**: 清空表格数据

### 状态控制
- **显示抽屉**: 手动显示底部抽屉
- **隐藏抽屉**: 手动隐藏底部抽屉
- **显示商品选择**: 手动显示商品选择弹窗
- **隐藏商品选择**: 手动隐藏商品选择弹窗

## 🔍 关键选择器

### 主要元素
```css
/* 提报按钮 */
.core-table .core-table-body .core-table-tr .core-table-td .pulse-button

/* 抽屉底部 */
.core-drawer-footer

/* 选择商品按钮 */
.core-drawer-footer .pulse-drawer-footer .space-x-12 button:nth-of-type(1)

/* 商品选择弹窗 */
.slideRight-enter-done

/* 商品复选框 */
.slideRight-enter-done .core-table-tr .core-checkbox input

/* 项目名称（敏感词检测） */
.text-neutral-text1
```

### 状态检测
```css
/* 抽屉显示状态 */
.core-drawer-footer.show

/* 弹窗显示状态 */
.slideRight-enter-done.show
```

## 📝 测试建议

### 1. 智能等待测试
- 先手动点击提报按钮
- 观察抽屉是否显示
- 在设计器中测试等待条件

### 2. 循环操作测试
- 确保表格中有多个项目
- 测试循环选择器是否正确
- 观察是否能找到所有按钮

### 3. 敏感词检测测试
- 添加包含"rally"的项目
- 测试敏感词检测功能
- 确认这些项目被正确跳过

### 4. 点击操作测试
- 确保抽屉已显示
- 测试选择商品按钮点击
- 观察商品弹窗是否出现

## 🐛 常见问题

### Q: 元素未找到
**A**: 检查选择器是否正确，确保页面元素已加载

### Q: 智能等待超时
**A**: 检查等待条件，确保属性值和比较方式正确

### Q: 敏感词检测不生效
**A**: 确认敏感词拼写正确，检测元素选择器正确

### Q: 循环操作只执行一次
**A**: 检查循环选择器，确保能选中多个元素

## 🎉 成功标志

当您看到以下日志时，说明测试成功：
- `🎯 点击了项目 X 的提报按钮`
- `✅ 智能等待完成 - 抽屉已显示`
- `🛍️ 点击选择商品按钮`
- `✅ 商品选择弹窗已显示`
- `✅ 确认选择了 X 个商品`

现在您可以开始测试了！🚀
