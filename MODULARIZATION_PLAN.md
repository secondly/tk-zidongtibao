# ğŸ“‹ JavaScriptæ–‡ä»¶æ¨¡å—åŒ–æ‹†åˆ†è®¡åˆ’

## ğŸ“Š å½“å‰æ–‡ä»¶çŠ¶æ€åˆ†æ (æ›´æ–°äº 2025å¹´7æœˆ20æ—¥)

| æ–‡ä»¶å | åŸå§‹è¡Œæ•° | å½“å‰çŠ¶æ€ | ä¼˜åŒ–çŠ¶æ€ | ä¼˜å…ˆçº§ | å¤‡æ³¨ |
|--------|----------|----------|----------|--------|------|
| **plugin-automation-popup.js** | ~4,200è¡Œ | âœ… å·²æ‹†åˆ† | ğŸ‰ å®Œæˆ | P0 | å·²æ‹†åˆ†ä¸º6ä¸ªæ¨¡å—ï¼Œä¸»æ–‡ä»¶ä»…150è¡Œ |
| **workflow-designer-mxgraph.js** | 2,684è¡Œ | âœ… å·²æ‹†åˆ† | ğŸ‰ å®Œæˆ | P0 | å·²æ‹†åˆ†ä¸º3ä¸ªæ¨¡å—ï¼Œä¸»æ–‡ä»¶400è¡Œ |
| **content/content.js** | 2,574è¡Œ | âœ… å·²æ‹†åˆ† | ğŸ‰ å®Œæˆ | P1 | å·²æ‹†åˆ†ä¸º2ä¸ªæ¨¡å—ï¼Œä¸»æ–‡ä»¶150è¡Œ |
| universal-automation-engine.js | 1,201è¡Œ | ğŸŸ¡ ~1,200è¡Œ | âš ï¸ æ¥è¿‘ä¸´ç•Œ | P2 | éœ€è¦ç›‘æ§ï¼Œæ¥è¿‘1500è¡Œ |
| workflow-designer.js | 1,386è¡Œ | ğŸŸ¡ 1,386è¡Œ | âš ï¸ æ¥è¿‘ä¸´ç•Œ | P2 | éœ€è¦ç›‘æ§ï¼Œæ¥è¿‘1500è¡Œ |

### ğŸ“ˆ ä¼˜åŒ–è¿›åº¦æ€»ç»“

#### âœ… å·²å®Œæˆçš„ä¼˜åŒ– (é˜¶æ®µ1)
- **plugin-automation-popup.js**: ä»4,200è¡Œæ‹†åˆ†ä¸º6ä¸ªæ¨¡å—
  - `modules/popup/popup-core.js` (~400è¡Œ)
  - `modules/popup/popup-config.js` (~400è¡Œ) 
  - `modules/popup/popup-execution.js` (~400è¡Œ)
  - `modules/popup/popup-persistence.js` (~350è¡Œ)
  - `modules/popup/popup-preview.js` (~350è¡Œ)
  - `modules/popup/popup-storage.js` (~300è¡Œ)
  - `shared/popup/popup-constants.js` (~100è¡Œ)
  - `shared/popup/popup-utils.js` (~200è¡Œ)
  - ä¸»æ–‡ä»¶ `plugin-automation-popup.js` ç°åœ¨åªæœ‰150è¡Œå¯¼å…¥å’Œåˆå§‹åŒ–ä»£ç 

#### âœ… å·²å®Œæˆçš„ä¼˜åŒ– (é˜¶æ®µ2)
1. **workflow-designer-mxgraph.js** (3,839è¡Œ â†’ 400è¡Œ) - **å·²å®Œæˆæ‹†åˆ†** âœ…
   - åŸæ–‡ä»¶ä»3,839è¡Œä¼˜åŒ–åˆ°400è¡Œï¼Œå‡å°‘äº†89.6%çš„ä»£ç é‡
   - å·²æ‹†åˆ†ä¸º3ä¸ªæ¨¡å— + 1ä¸ªä¸»æ–‡ä»¶ï¼š
   - `modules/designer/designer-core.js` (~1,063è¡Œ) - æ ¸å¿ƒåŠŸèƒ½å’ŒmxGraphåˆå§‹åŒ–
   - `modules/designer/designer-nodes.js` (~1,475è¡Œ) - èŠ‚ç‚¹ç®¡ç†å’Œå±æ€§é¢æ¿
   - `modules/designer/designer-workflow.js` (~500è¡Œ) - å·¥ä½œæµå¯¼å…¥å¯¼å‡ºç®¡ç†
   - `workflow-designer-mxgraph.js` (~400è¡Œ) - æ¨¡å—åŒ–ä¸»æ–‡ä»¶ï¼ˆå·²æ›¿æ¢åŸæ–‡ä»¶ï¼‰
   
2. **content/content.js** (2,574è¡Œ â†’ 150è¡Œ) - **å·²å®Œæˆæ‹†åˆ†** âœ…
   - åŸæ–‡ä»¶ä»2,574è¡Œæ‹†åˆ†ä¸º2ä¸ªæ¨¡å— + 1ä¸ªä¸»æ–‡ä»¶ï¼Œå‡å°‘äº†94.2%çš„ä»£ç é‡
   - å·²æ‹†åˆ†ä¸º2ä¸ªæ¨¡å— + 1ä¸ªä¸»æ–‡ä»¶ï¼š
   - `modules/content/content-core.js` (~1,300è¡Œ) - æ ¸å¿ƒåŠŸèƒ½ã€æ¶ˆæ¯å¤„ç†ã€å…ƒç´ æŸ¥æ‰¾
   - `modules/content/content-automation.js` (~1,200è¡Œ) - è‡ªåŠ¨åŒ–æ‰§è¡Œã€å·¥ä½œæµå¤„ç†
   - `content/content-modular.js` (~150è¡Œ) - æ¨¡å—åŒ–ä¸»æ–‡ä»¶

#### âš ï¸ éœ€è¦ç›‘æ§çš„æ–‡ä»¶
- `universal-automation-engine.js` (~1,200è¡Œ) - æ¥è¿‘1500è¡Œä¸´ç•Œå€¼
- `workflow-designer.js` (1,386è¡Œ) - æ¥è¿‘1500è¡Œä¸´ç•Œå€¼

#### ğŸ†• æ–°å¢çš„ä¼˜åŒ–æ¨¡å—
- `shared/popup/popup-performance.js` (~300è¡Œ) - æ€§èƒ½ç›‘æ§
- `shared/popup/popup-validation.js` (~400è¡Œ) - æ•°æ®éªŒè¯  
- `shared/popup/popup-error-handler.js` (~350è¡Œ) - é”™è¯¯å¤„ç†
- `utils/performancePanel.js` (~500è¡Œ) - æ€§èƒ½é¢æ¿

## ğŸ¯ æ‹†åˆ†ç›®æ ‡

- âœ… æ¯ä¸ªæ–‡ä»¶ < 1,500è¡Œ
- âœ… æ¨¡å—åŒ–è®¾è®¡ï¼ŒèŒè´£å•ä¸€
- âœ… ä¿æŒåŠŸèƒ½å®Œæ•´æ€§
- âœ… æé«˜ä»£ç å¯ç»´æŠ¤æ€§
- âœ… ä¾¿äºå›¢é˜Ÿåä½œå¼€å‘
- âœ… æå‡ä»£ç å¤ç”¨æ€§

## ğŸ“‹ è¯¦ç»†æ‹†åˆ†è®¡åˆ’

### ğŸš€ é˜¶æ®µ1ï¼šplugin-automation-popup.js æ‹†åˆ† (P0)
**å½“å‰ï¼š~4,200è¡Œ â†’ ç›®æ ‡ï¼š7ä¸ªæ–‡ä»¶å„<1,500è¡Œ**

#### 1.1 æ ¸å¿ƒæ¨¡å—æ‹†åˆ†
```
ğŸ“ modules/popup/
â”œâ”€â”€ ğŸ“„ popup-core.js (~800è¡Œ)
â”‚   â”œâ”€â”€ å…¨å±€å˜é‡å®šä¹‰
â”‚   â”œâ”€â”€ åˆå§‹åŒ–é€»è¾‘ (DOMContentLoaded)
â”‚   â”œâ”€â”€ ä¸‰æ å¸ƒå±€ç®¡ç† (initializeLayout)
â”‚   â”œâ”€â”€ åŸºç¡€äº‹ä»¶ç›‘å¬å™¨ (initializeEventListeners)
â”‚   â””â”€â”€ ä¸»è¦å…¥å£å‡½æ•°
â”‚
â”œâ”€â”€ ğŸ“„ popup-execution.js (~900è¡Œ)
â”‚   â”œâ”€â”€ æ‰§è¡ŒçŠ¶æ€ç®¡ç† (executionState)
â”‚   â”œâ”€â”€ å·¥ä½œæµæ‰§è¡Œæ§åˆ¶ (executeWorkflow)
â”‚   â”œâ”€â”€ æš‚åœ/ç»§ç»­/åœæ­¢åŠŸèƒ½ (togglePauseResume, stopExecution)
â”‚   â”œâ”€â”€ æ‰§è¡Œè¿›åº¦æ˜¾ç¤º (updateExecutionUI)
â”‚   â”œâ”€â”€ é‡ç½®æ‰§è¡ŒçŠ¶æ€ (resetExecutionState)
â”‚   â””â”€â”€ æ‰§è¡Œæ¶ˆæ¯å¤„ç†
â”‚
â”œâ”€â”€ ğŸ“„ popup-config.js (~800è¡Œ)
â”‚   â”œâ”€â”€ é…ç½®ç®¡ç†åŠŸèƒ½ (loadSavedWorkflows)
â”‚   â”œâ”€â”€ ç¼–è¾‘/åˆ é™¤é…ç½® (editCurrentConfig, deleteCurrentConfig)
â”‚   â”œâ”€â”€ é…ç½®é€‰æ‹©å’Œæ˜¾ç¤º (selectConfig, handleConfigSelectChange)
â”‚   â”œâ”€â”€ é…ç½®æ“ä½œäº‹ä»¶ (initializeConfigActionListeners)
â”‚   â”œâ”€â”€ å·¥ä½œæµç¼“å­˜ç®¡ç† (openDesignerWithWorkflow)
â”‚   â””â”€â”€ é…ç½®åˆ—è¡¨æ¸²æŸ“ (renderConfigSelect)
â”‚
â”œâ”€â”€ ğŸ“„ popup-persistence.js (~600è¡Œ)
â”‚   â”œâ”€â”€ çŠ¶æ€æŒä¹…åŒ–åŠŸèƒ½ (initializeStatePersistence)
â”‚   â”œâ”€â”€ ç¼“å­˜ç®¡ç† (saveStateBeforeClose, restoreExecutionState)
â”‚   â”œâ”€â”€ æ•°æ®æ¢å¤ (restoreWorkflowCache, restoreExecutionStateCache)
â”‚   â”œâ”€â”€ æ¸…ç†åŠŸèƒ½ (clearStateCache, handleClearCache)
â”‚   â””â”€â”€ é¡µé¢å¯è§æ€§å¤„ç† (handleVisibilityChange)
â”‚
â”œâ”€â”€ ğŸ“„ popup-preview.js (~400è¡Œ)
â”‚   â”œâ”€â”€ æµç¨‹å›¾é¢„è§ˆ (renderFlowPreview)
â”‚   â”œâ”€â”€ mxGraphé›†æˆ (setupPreviewStyles, renderWorkflowInPreview)
â”‚   â”œâ”€â”€ ç®€å•é¢„è§ˆæ¸²æŸ“ (renderSimpleFlowPreview, drawSimpleFlowChart)
â”‚   â”œâ”€â”€ é¢„è§ˆäº¤äº’ (clearFlowPreview)
â”‚   â””â”€â”€ ç”»å¸ƒæ“ä½œ
â”‚
â””â”€â”€ ğŸ“„ popup-storage.js (~400è¡Œ)
    â”œâ”€â”€ localStorageç®¡ç† (getWorkflowsFromStorage, saveWorkflowsToStorage)
    â”œâ”€â”€ æ•°æ®è°ƒè¯• (debugLocalStorage)
    â”œâ”€â”€ å­˜å‚¨ç›‘å¬ (initializeStorageListener)
    â””â”€â”€ æ•°æ®éªŒè¯å’Œè¿ç§»
```

#### 1.2 å…¬å…±å·¥å…·æ¨¡å—
```
ğŸ“ shared/popup/
â”œâ”€â”€ ğŸ“„ popup-utils.js (~200è¡Œ)
â”‚   â”œâ”€â”€ é€šç”¨å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ çŠ¶æ€æ›´æ–°å‡½æ•° (updateExecutionStatus)
â”‚   â”œâ”€â”€ æ¶ˆæ¯æ˜¾ç¤ºå‡½æ•° (showStatus)
â”‚   â”œâ”€â”€ æ•°æ®éªŒè¯å‡½æ•°
â”‚   â””â”€â”€ DOMæ“ä½œè¾…åŠ©å‡½æ•°
â”‚
â”œâ”€â”€ ğŸ“„ popup-constants.js (~100è¡Œ)
â”‚   â”œâ”€â”€ å¸¸é‡å®šä¹‰ (STATE_CACHE_KEY, WORKFLOW_CACHE_KEY)
â”‚   â”œâ”€â”€ é…ç½®é¡¹ (STORAGE_KEY)
â”‚   â”œâ”€â”€ é»˜è®¤å€¼
â”‚   â””â”€â”€ çŠ¶æ€ç±»å‹å®šä¹‰
â”‚
â””â”€â”€ ğŸ“„ popup-types.js (~100è¡Œ)
    â”œâ”€â”€ TypeScriptç±»å‹å®šä¹‰ (å¦‚æœéœ€è¦)
    â”œâ”€â”€ æ¥å£å®šä¹‰
    â””â”€â”€ æ•°æ®ç»“æ„å®šä¹‰
```

### ğŸ¨ é˜¶æ®µ2ï¼šworkflow-designer-mxgraph.js æ‹†åˆ† (P0)
**å½“å‰ï¼š2,684è¡Œ â†’ ç›®æ ‡ï¼š3ä¸ªæ–‡ä»¶å„<1,500è¡Œ**

#### 2.1 è®¾è®¡å™¨æ ¸å¿ƒæ‹†åˆ†
```
ğŸ“ modules/designer/
â”œâ”€â”€ ğŸ“„ designer-core.js (~1,200è¡Œ)
â”‚   â”œâ”€â”€ MxGraphWorkflowDesignerç±»å®šä¹‰
â”‚   â”œâ”€â”€ åˆå§‹åŒ–é€»è¾‘ (init, waitForMxGraph, initMxGraph)
â”‚   â”œâ”€â”€ å›¾å½¢æ“ä½œåŸºç¡€ (setupStyles, setupResizeListener)
â”‚   â”œâ”€â”€ äº‹ä»¶ç›‘å¬å™¨ (initEventListeners)
â”‚   â”œâ”€â”€ å³é”®èœå•å¤„ç† (setupContextMenu)
â”‚   â””â”€â”€ åŸºç¡€å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ ğŸ“„ designer-nodes.js (~800è¡Œ)
â”‚   â”œâ”€â”€ èŠ‚ç‚¹åˆ›å»ºå’Œç®¡ç† (createNode, addNodeToGraph)
â”‚   â”œâ”€â”€ èŠ‚ç‚¹é…ç½®ç¼–è¾‘ (showPropertyPanel, saveNodeConfig)
â”‚   â”œâ”€â”€ å±æ€§é¢æ¿ç®¡ç† (bindPropertyFormEvents)
â”‚   â”œâ”€â”€ èŠ‚ç‚¹æ ·å¼è®¾ç½® (updateNodeDisplay)
â”‚   â”œâ”€â”€ èŠ‚ç‚¹åˆ é™¤å’Œå¤åˆ¶ (deleteNode)
â”‚   â””â”€â”€ èŠ‚ç‚¹éªŒè¯å’Œæµ‹è¯• (testLocator, testCondition)
â”‚
â””â”€â”€ ğŸ“„ designer-workflow.js (~684è¡Œ)
    â”œâ”€â”€ å·¥ä½œæµå¯¼å…¥å¯¼å‡º (exportWorkflowData, importWorkflowData)
    â”œâ”€â”€ æ•°æ®è½¬æ¢é€»è¾‘ (ä¸workflowConverter.jsé…åˆ)
    â”œâ”€â”€ ä¿å­˜å’ŒåŠ è½½ (saveWorkflowWithDialog, loadWorkflowFromStorage)
    â”œâ”€â”€ ç¼–è¾‘æ¨¡å¼å¤„ç† (editModeç›¸å…³é€»è¾‘)
    â”œâ”€â”€ æ–‡ä»¶æ“ä½œ (loadWorkflowFromFile, exportData)
    â””â”€â”€ ç”»å¸ƒç®¡ç† (clearCanvas, updateNodeCount)
```

### ğŸ“± é˜¶æ®µ3ï¼šcontent/content.js æ‹†åˆ† (P1)
**å½“å‰ï¼š2,200è¡Œ â†’ ç›®æ ‡ï¼š2ä¸ªæ–‡ä»¶å„<1,500è¡Œ**

#### 3.1 å†…å®¹è„šæœ¬æ‹†åˆ†
```
ğŸ“ modules/content/
â”œâ”€â”€ ğŸ“„ content-core.js (~1,100è¡Œ)
â”‚   â”œâ”€â”€ å†…å®¹è„šæœ¬åˆå§‹åŒ–
â”‚   â”œâ”€â”€ é¡µé¢å…ƒç´ æ“ä½œ (DOMæŸ¥æ‰¾å’Œæ“ä½œ)
â”‚   â”œâ”€â”€ æ¶ˆæ¯é€šä¿¡ (ä¸backgroundå’Œpopupé€šä¿¡)
â”‚   â”œâ”€â”€ åŸºç¡€åŠŸèƒ½ (é¡µé¢æ³¨å…¥ã€äº‹ä»¶ç›‘å¬)
â”‚   â”œâ”€â”€ å…ƒç´ é«˜äº®å’Œæ ‡è®°
â”‚   â””â”€â”€ é¡µé¢çŠ¶æ€ç®¡ç†
â”‚
â””â”€â”€ ğŸ“„ content-automation.js (~1,100è¡Œ)
    â”œâ”€â”€ è‡ªåŠ¨åŒ–æ‰§è¡Œé€»è¾‘ (æ­¥éª¤æ‰§è¡Œå¼•æ“)
    â”œâ”€â”€ å…ƒç´ å®šä½å’Œæ“ä½œ (ç‚¹å‡»ã€è¾“å…¥ã€é€‰æ‹©)
    â”œâ”€â”€ ç­‰å¾…å’Œæ¡ä»¶åˆ¤æ–­ (æ™ºèƒ½ç­‰å¾…ã€çŠ¶æ€æ£€æµ‹)
    â”œâ”€â”€ å¾ªç¯å’Œæµç¨‹æ§åˆ¶ (å¾ªç¯æ‰§è¡Œã€æ¡ä»¶åˆ†æ”¯)
    â”œâ”€â”€ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
    â””â”€â”€ æ‰§è¡Œç»“æœåé¦ˆ
```

### ğŸ”§ é˜¶æ®µ4ï¼šå…¶ä»–æ–‡ä»¶ä¼˜åŒ– (P2)
**ä¼˜åŒ–æ¥è¿‘1,500è¡Œçš„æ–‡ä»¶**

#### 4.1 workflow-designer.js (1,386è¡Œ)
```
ğŸ“ modules/designer-legacy/
â”œâ”€â”€ ğŸ“„ designer-legacy-core.js (~800è¡Œ)
â”‚   â”œâ”€â”€ æ—§ç‰ˆè®¾è®¡å™¨æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ åŸºç¡€å›¾å½¢æ“ä½œ
â”‚   â””â”€â”€ äº‹ä»¶å¤„ç†
â”‚
â””â”€â”€ ğŸ“„ designer-legacy-ui.js (~586è¡Œ)
    â”œâ”€â”€ UIç»„ä»¶ç®¡ç†
    â”œâ”€â”€ å·¥å…·æ æ“ä½œ
    â””â”€â”€ ç•Œé¢äº¤äº’
```

#### 4.2 universal-automation-engine.js (1,201è¡Œ)
```
ğŸ“ modules/engine/
â”œâ”€â”€ ğŸ“„ automation-engine-core.js (~700è¡Œ)
â”‚   â”œâ”€â”€ UniversalAutomationEngineç±»
â”‚   â”œâ”€â”€ å¼•æ“åˆå§‹åŒ–å’Œé…ç½®
â”‚   â”œâ”€â”€ æ¶ˆæ¯å¤„ç†æœºåˆ¶
â”‚   â””â”€â”€ çŠ¶æ€ç®¡ç†
â”‚
â””â”€â”€ ğŸ“„ automation-engine-operations.js (~501è¡Œ)
    â”œâ”€â”€ å…·ä½“æ“ä½œå®ç° (ç‚¹å‡»ã€è¾“å…¥ã€ç­‰å¾…ç­‰)
    â”œâ”€â”€ å…ƒç´ å®šä½ç­–ç•¥
    â”œâ”€â”€ æ“ä½œéªŒè¯å’Œé”™è¯¯å¤„ç†
    â””â”€â”€ ç»“æœåé¦ˆæœºåˆ¶
```

## ğŸ”§ å…¬å…±æ¨¡å—æå–

### é€šç”¨å·¥å…·æ¨¡å—
```
ğŸ“ shared/common/
â”œâ”€â”€ ğŸ“„ common-utils.js (~300è¡Œ)
â”‚   â”œâ”€â”€ DOMæ“ä½œå·¥å…· (querySelectorå¢å¼ºã€å…ƒç´ æ£€æµ‹)
â”‚   â”œâ”€â”€ æ•°æ®å¤„ç†å·¥å…· (æ·±æ‹·è´ã€å¯¹è±¡åˆå¹¶ã€æ•°ç»„æ“ä½œ)
â”‚   â”œâ”€â”€ éªŒè¯å·¥å…· (æ•°æ®éªŒè¯ã€ç±»å‹æ£€æŸ¥)
â”‚   â”œâ”€â”€ æ ¼å¼åŒ–å·¥å…· (æ—¶é—´æ ¼å¼åŒ–ã€æ–‡æœ¬å¤„ç†)
â”‚   â””â”€â”€ è°ƒè¯•å·¥å…· (æ—¥å¿—ç®¡ç†ã€é”™è¯¯è¿½è¸ª)
â”‚
â”œâ”€â”€ ğŸ“„ storage-manager.js (~400è¡Œ)
â”‚   â”œâ”€â”€ localStorageç®¡ç† (ç»Ÿä¸€çš„å­˜å‚¨æ¥å£)
â”‚   â”œâ”€â”€ æ•°æ®åºåˆ—åŒ– (JSONå¤„ç†ã€æ•°æ®å‹ç¼©)
â”‚   â”œâ”€â”€ ç¼“å­˜ç®¡ç† (è¿‡æœŸæœºåˆ¶ã€æ¸…ç†ç­–ç•¥)
â”‚   â”œâ”€â”€ æ•°æ®è¿ç§» (ç‰ˆæœ¬å‡çº§ã€æ•°æ®å…¼å®¹)
â”‚   â””â”€â”€ å­˜å‚¨é…é¢ç®¡ç†
â”‚
â”œâ”€â”€ ğŸ“„ event-manager.js (~300è¡Œ)
â”‚   â”œâ”€â”€ äº‹ä»¶ç›‘å¬ç®¡ç† (ç»Ÿä¸€çš„äº‹ä»¶å¤„ç†)
â”‚   â”œâ”€â”€ æ¶ˆæ¯é€šä¿¡ (è·¨ç»„ä»¶é€šä¿¡æœºåˆ¶)
â”‚   â”œâ”€â”€ è·¨çª—å£é€šä¿¡ (popupä¸contenté€šä¿¡)
â”‚   â”œâ”€â”€ äº‹ä»¶ä»£ç† (æ€§èƒ½ä¼˜åŒ–)
â”‚   â””â”€â”€ è‡ªå®šä¹‰äº‹ä»¶ç³»ç»Ÿ
â”‚
â”œâ”€â”€ ğŸ“„ ui-helpers.js (~400è¡Œ)
â”‚   â”œâ”€â”€ UIçŠ¶æ€ç®¡ç† (åŠ è½½çŠ¶æ€ã€é”™è¯¯çŠ¶æ€)
â”‚   â”œâ”€â”€ åŠ¨ç”»æ•ˆæœ (è¿‡æ¸¡åŠ¨ç”»ã€åŠ è½½åŠ¨ç”»)
â”‚   â”œâ”€â”€ ä¸»é¢˜åˆ‡æ¢ (æ·±è‰²/æµ…è‰²æ¨¡å¼)
â”‚   â”œâ”€â”€ å“åº”å¼å¤„ç† (çª—å£å¤§å°é€‚é…)
â”‚   â””â”€â”€ é€šç”¨UIç»„ä»¶ (æ¨¡æ€æ¡†ã€æç¤ºæ¡†)
â”‚
â””â”€â”€ ğŸ“„ workflow-types.js (~200è¡Œ)
    â”œâ”€â”€ å·¥ä½œæµæ•°æ®ç±»å‹å®šä¹‰
    â”œâ”€â”€ æ­¥éª¤ç±»å‹æšä¸¾
    â”œâ”€â”€ çŠ¶æ€ç±»å‹å®šä¹‰
    â””â”€â”€ æ¥å£è§„èŒƒ
```

## ğŸ“… æ‰§è¡Œæ—¶é—´è¡¨

### ğŸ—“ï¸ ç¬¬1å‘¨ï¼šplugin-automation-popup.js æ‹†åˆ†
- **Day 1-2**: 
  - ğŸ“‹ åˆ†æä»£ç ç»“æ„ï¼Œè¯†åˆ«æ¨¡å—è¾¹ç•Œ
  - ğŸ—ï¸ åˆ›å»ºæ¨¡å—æ¡†æ¶å’Œç›®å½•ç»“æ„
  - ğŸ“„ åˆ›å»º popup-constants.js å’Œ popup-utils.js
  
- **Day 3-4**: 
  - ğŸ”§ æ‹†åˆ†æ ¸å¿ƒæ¨¡å— (popup-core.js)
  - âš¡ æ‹†åˆ†æ‰§è¡Œæ¨¡å— (popup-execution.js)
  - ğŸ§ª åŸºç¡€åŠŸèƒ½æµ‹è¯•
  
- **Day 5-6**: 
  - âš™ï¸ æ‹†åˆ†é…ç½®æ¨¡å— (popup-config.js)
  - ğŸ’¾ æ‹†åˆ†æŒä¹…åŒ–æ¨¡å— (popup-persistence.js)
  - ğŸ”— æ¨¡å—é—´ä¾èµ–æ•´ç†
  
- **Day 7**: 
  - ğŸ–¼ï¸ æ‹†åˆ†é¢„è§ˆæ¨¡å— (popup-preview.js)
  - ğŸ’¾ æ‹†åˆ†å­˜å‚¨æ¨¡å— (popup-storage.js)
  - âœ… é›†æˆæµ‹è¯•å’ŒåŠŸèƒ½éªŒè¯

### ğŸ—“ï¸ ç¬¬2å‘¨ï¼šworkflow-designer-mxgraph.js æ‹†åˆ†
- **Day 1-2**: 
  - ğŸ¨ æ‹†åˆ†è®¾è®¡å™¨æ ¸å¿ƒ (designer-core.js)
  - ğŸ§ª æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
  
- **Day 3-4**: 
  - ğŸ”² æ‹†åˆ†èŠ‚ç‚¹ç®¡ç† (designer-nodes.js)
  - ğŸ›ï¸ å±æ€§é¢æ¿åŠŸèƒ½æµ‹è¯•
  
- **Day 5-6**: 
  - ğŸ“Š æ‹†åˆ†å·¥ä½œæµå¤„ç† (designer-workflow.js)
  - ğŸ’¾ å¯¼å…¥å¯¼å‡ºåŠŸèƒ½æµ‹è¯•
  
- **Day 7**: 
  - ğŸ”— æ¨¡å—é›†æˆæµ‹è¯•
  - ğŸ› é—®é¢˜ä¿®å¤å’Œä¼˜åŒ–

### ğŸ—“ï¸ ç¬¬3å‘¨ï¼šcontent.js å’Œå…¶ä»–æ–‡ä»¶
- **Day 1-3**: 
  - ğŸ“± æ‹†åˆ† content.js (content-core.js, content-automation.js)
  - ğŸ§ª å†…å®¹è„šæœ¬åŠŸèƒ½æµ‹è¯•
  
- **Day 4-5**: 
  - ğŸ¨ ä¼˜åŒ– workflow-designer.js
  - ğŸ§ª æ—§ç‰ˆè®¾è®¡å™¨æµ‹è¯•
  
- **Day 6-7**: 
  - âš¡ ä¼˜åŒ– universal-automation-engine.js
  - ğŸ§ª è‡ªåŠ¨åŒ–å¼•æ“æµ‹è¯•

### ğŸ—“ï¸ ç¬¬4å‘¨ï¼šå…¬å…±æ¨¡å—å’Œæµ‹è¯•
- **Day 1-3**: 
  - ğŸ”§ æå–å…¬å…±æ¨¡å— (common-utils.js, storage-manager.jsç­‰)
  - ğŸ”— é‡æ„æ¨¡å—ä¾èµ–å…³ç³»
  
- **Day 4-5**: 
  - âœ… å…¨é¢åŠŸèƒ½æµ‹è¯•
  - ğŸ› é—®é¢˜ä¿®å¤
  
- **Day 6-7**: 
  - âš¡ æ€§èƒ½ä¼˜åŒ–
  - ğŸ“š æ–‡æ¡£æ›´æ–°

## ğŸ¯ æ‹†åˆ†åŸåˆ™

### 1. ğŸ¯ å•ä¸€èŒè´£åŸåˆ™ (SRP)
- æ¯ä¸ªæ¨¡å—åªè´Ÿè´£ä¸€ä¸ªç‰¹å®šåŠŸèƒ½é¢†åŸŸ
- é¿å…åŠŸèƒ½æ··æ‚ï¼Œä¿æŒæ¨¡å—çº¯å‡€æ€§
- ä¾¿äºç†è§£ã€æµ‹è¯•å’Œç»´æŠ¤

### 2. ğŸ”— ä½è€¦åˆåŸåˆ™
- æ¨¡å—é—´ä¾èµ–æœ€å°åŒ–
- é€šè¿‡æ¥å£å’Œäº‹ä»¶è¿›è¡Œé€šä¿¡
- é¿å…ç›´æ¥è®¿é—®å…¶ä»–æ¨¡å—çš„å†…éƒ¨å®ç°

### 3. ğŸ—ï¸ é«˜å†…èšåŸåˆ™
- ç›¸å…³åŠŸèƒ½é›†ä¸­åœ¨åŒä¸€æ¨¡å—
- æ¨¡å—å†…éƒ¨åŠŸèƒ½ç´§å¯†åä½œ
- å‡å°‘è·¨æ¨¡å—çš„æ•°æ®ä¼ é€’

### 4. ğŸ§ª å¯æµ‹è¯•æ€§åŸåˆ™
- æ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•
- æä¾›æ¸…æ™°çš„è¾“å…¥è¾“å‡ºæ¥å£
- ä¾¿äºå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

### 5. ğŸ”„ å‘åå…¼å®¹åŸåˆ™
- ä¿æŒç°æœ‰APIä¸å˜
- æ¸è¿›å¼é‡æ„ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½
- æä¾›å¹³æ»‘çš„è¿ç§»è·¯å¾„

### 6. ğŸ“ˆ å¯æ‰©å±•æ€§åŸåˆ™
- é¢„ç•™æ‰©å±•æ¥å£
- æ”¯æŒæ’ä»¶åŒ–æ¶æ„
- ä¾¿äºæœªæ¥åŠŸèƒ½æ·»åŠ 

## ğŸ“‹ æ¨¡å—ä¾èµ–å…³ç³»å›¾

```mermaid
graph TD
    A[popup-core.js] --> B[popup-utils.js]
    A --> C[popup-constants.js]
    
    D[popup-execution.js] --> B
    D --> C
    D --> E[event-manager.js]
    
    F[popup-config.js] --> B
    F --> C
    F --> G[storage-manager.js]
    
    H[popup-persistence.js] --> B
    H --> C
    H --> G
    
    I[popup-preview.js] --> B
    I --> J[ui-helpers.js]
    
    K[popup-storage.js] --> G
    K --> L[common-utils.js]
    
    M[designer-core.js] --> L
    M --> E
    
    N[designer-nodes.js] --> L
    N --> J
    
    O[designer-workflow.js] --> G
    O --> L
```

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•
- æ¯ä¸ªæ¨¡å—ç‹¬ç«‹æµ‹è¯•
- è¦†ç›–æ ¸å¿ƒåŠŸèƒ½å’Œè¾¹ç•Œæƒ…å†µ
- ä½¿ç”¨Jestæˆ–ç±»ä¼¼æµ‹è¯•æ¡†æ¶

### é›†æˆæµ‹è¯•
- æ¨¡å—é—´åä½œæµ‹è¯•
- ç«¯åˆ°ç«¯åŠŸèƒ½éªŒè¯
- ç”¨æˆ·åœºæ™¯æ¨¡æ‹Ÿ

### æ€§èƒ½æµ‹è¯•
- æ¨¡å—åŠ è½½æ—¶é—´æµ‹è¯•
- å†…å­˜ä½¿ç”¨ç›‘æ§
- æ‰§è¡Œæ•ˆç‡å¯¹æ¯”

## ğŸ“Š æˆåŠŸæŒ‡æ ‡

### ä»£ç è´¨é‡æŒ‡æ ‡
- âœ… æ‰€æœ‰æ–‡ä»¶ < 1,500è¡Œ
- âœ… ä»£ç é‡å¤ç‡ < 5%
- âœ… åœˆå¤æ‚åº¦ < 10
- âœ… æµ‹è¯•è¦†ç›–ç‡ > 80%

### æ€§èƒ½æŒ‡æ ‡
- âœ… é¡µé¢åŠ è½½æ—¶é—´ä¸å¢åŠ 
- âœ… å†…å­˜ä½¿ç”¨ä¸è¶…è¿‡åŸæ¥çš„120%
- âœ… åŠŸèƒ½å“åº”æ—¶é—´ä¿æŒä¸€è‡´

### ç»´æŠ¤æ€§æŒ‡æ ‡
- âœ… æ–°åŠŸèƒ½å¼€å‘æ•ˆç‡æå‡30%
- âœ… Bugä¿®å¤æ—¶é—´å‡å°‘50%
- âœ… ä»£ç å®¡æŸ¥æ—¶é—´å‡å°‘40%

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨è®¡åˆ’ (æ›´æ–°äº 2025å¹´7æœˆ22æ—¥)

### âœ… å·²å®Œæˆçš„ä¼˜åŒ–ä»»åŠ¡

#### 1. **workflow-designer-mxgraph.js** æ‹†åˆ† - **å·²å®Œæˆ** âœ…
**çŠ¶æ€**: ä» 2,684è¡Œ æ‹†åˆ†ä¸º 3ä¸ªæ¨¡å— + 1ä¸ªä¸»æ–‡ä»¶
- `modules/designer/designer-core.js` (~1,063è¡Œ) - æ ¸å¿ƒåŠŸèƒ½å’ŒmxGraphåˆå§‹åŒ–
- `modules/designer/designer-nodes.js` (~1,475è¡Œ) - èŠ‚ç‚¹ç®¡ç†å’Œå±æ€§é¢æ¿  
- `modules/designer/designer-workflow.js` (~500è¡Œ) - å·¥ä½œæµå¯¼å…¥å¯¼å‡ºç®¡ç†
- `workflow-designer-mxgraph.js` (~400è¡Œ) - æ¨¡å—åŒ–ä¸»æ–‡ä»¶

#### 2. **content/content.js** æ‹†åˆ† - **å·²å®Œæˆ** âœ…
**çŠ¶æ€**: ä» 2,574è¡Œ æ‹†åˆ†ä¸º 2ä¸ªæ¨¡å— + 1ä¸ªä¸»æ–‡ä»¶
- `modules/content/content-core.js` (~1,300è¡Œ) - æ ¸å¿ƒåŠŸèƒ½ã€æ¶ˆæ¯å¤„ç†ã€å…ƒç´ æŸ¥æ‰¾
- `modules/content/content-automation.js` (~1,200è¡Œ) - è‡ªåŠ¨åŒ–æ‰§è¡Œã€å·¥ä½œæµå¤„ç†  
- `content/content-modular.js` (~150è¡Œ) - æ¨¡å—åŒ–ä¸»æ–‡ä»¶

#### 3. **æ’ä»¶é…ç½®æ›´æ–°** - **å·²å®Œæˆ** âœ…
**çŠ¶æ€**: æ›´æ–°æ’ä»¶é…ç½®ä»¥ä½¿ç”¨æ–°çš„æ¨¡å—åŒ–ä»£ç 
- æ›´æ–° `manifest.json` ä½¿ç”¨ `content/content-modular.js` ä½œä¸ºå†…å®¹è„šæœ¬
- æ·»åŠ æ‰€æœ‰æ¨¡å—æ–‡ä»¶åˆ° `web_accessible_resources` 
- åˆ›å»ºæµ‹è¯•é¡µé¢ `test-modular-content.html` éªŒè¯æ¨¡å—åŠ è½½
- ç¡®ä¿å·¥ä½œæµè®¾è®¡å™¨ä½¿ç”¨æ¨¡å—åŒ–è„šæœ¬

### âš ï¸ ç›‘æ§ä»»åŠ¡ (æŒç»­å…³æ³¨)

#### éœ€è¦å¯†åˆ‡ç›‘æ§çš„æ–‡ä»¶:
1. **universal-automation-engine.js** (~1,200è¡Œ)
   - ğŸ¯ ç›®æ ‡: ä¿æŒåœ¨1,500è¡Œä»¥ä¸‹
   - ğŸ“Š å½“å‰çŠ¶æ€: æ¥è¿‘ä¸´ç•Œå€¼ï¼Œéœ€è¦ç›‘æ§

2. **workflow-designer.js** (1,386è¡Œ)  
   - ğŸ¯ ç›®æ ‡: ä¿æŒåœ¨1,500è¡Œä»¥ä¸‹
   - ğŸ“Š å½“å‰çŠ¶æ€: æ¥è¿‘ä¸´ç•Œå€¼ï¼Œéœ€è¦ç›‘æ§

### ğŸ“‹ è¯¦ç»†æ‰§è¡Œè®¡åˆ’

#### ç¬¬1é˜¶æ®µ: workflow-designer-mxgraph.js æ‹†åˆ† (æœ¬å‘¨)
```
ğŸ—“ï¸ æ—¶é—´å®‰æ’: 7å¤©
ğŸ‘¥ äººå‘˜éœ€æ±‚: 1åå¼€å‘è€…
ğŸ¯ æˆåŠŸæ ‡å‡†: 
  - 3ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ª<1,500è¡Œ
  - åŠŸèƒ½å®Œæ•´æ€§100%ä¿æŒ
  - æ€§èƒ½æ— æ˜æ˜¾ä¸‹é™
```

#### ç¬¬2é˜¶æ®µ: content/content.js æ‹†åˆ† (ä¸‹å‘¨)
```  
ğŸ—“ï¸ æ—¶é—´å®‰æ’: 3å¤©
ğŸ‘¥ äººå‘˜éœ€æ±‚: 1åå¼€å‘è€…  
ğŸ¯ æˆåŠŸæ ‡å‡†:
  - 2ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ª<1,500è¡Œ
  - è‡ªåŠ¨åŒ–åŠŸèƒ½æ­£å¸¸
  - æ¶ˆæ¯é€šä¿¡æ— é—®é¢˜
```

### ğŸ§ª æµ‹è¯•éªŒè¯è®¡åˆ’

#### åŠŸèƒ½æµ‹è¯•æ£€æŸ¥æ¸…å•:
- [ ] è®¾è®¡å™¨æ‰“å¼€å’Œåˆå§‹åŒ–æ­£å¸¸
- [ ] èŠ‚ç‚¹åˆ›å»ºå’Œç¼–è¾‘åŠŸèƒ½æ­£å¸¸  
- [ ] å·¥ä½œæµå¯¼å…¥å¯¼å‡ºåŠŸèƒ½æ­£å¸¸
- [ ] å³é”®èœå•å’Œå¿«æ·é”®æ­£å¸¸
- [ ] å±æ€§é¢æ¿é…ç½®æ­£å¸¸
- [ ] æµç¨‹å›¾é¢„è§ˆæ­£å¸¸
- [ ] è‡ªåŠ¨åŒ–æ‰§è¡ŒåŠŸèƒ½æ­£å¸¸
- [ ] å†…å®¹è„šæœ¬æ³¨å…¥æ­£å¸¸

#### æ€§èƒ½æµ‹è¯•æ£€æŸ¥:
- [ ] é¡µé¢åŠ è½½æ—¶é—´ < 3ç§’
- [ ] å†…å­˜ä½¿ç”¨ < åŸæ¥çš„120%  
- [ ] æ“ä½œå“åº”æ—¶é—´ < 500ms
- [ ] æ¨¡å—åŠ è½½æ— æ˜æ˜¾å»¶è¿Ÿ

### ç«‹å³è¡ŒåŠ¨é¡¹
1. **ğŸ¯ å¼€å§‹ workflow-designer-mxgraph.js æ‹†åˆ†**: ç«‹å³å¼€å§‹åˆ†æä»£ç ç»“æ„
2. **ğŸ“‹ å»ºç«‹æµ‹è¯•åŸºå‡†**: è®°å½•å½“å‰åŠŸèƒ½å’Œæ€§èƒ½åŸºå‡†
3. **ğŸ—ï¸ å‡†å¤‡å¼€å‘ç¯å¢ƒ**: ç¡®ä¿æ¨¡å—åŒ–å¼€å‘ç¯å¢ƒå°±ç»ª
4. **ğŸ§ª åˆ¶å®šæµ‹è¯•è®¡åˆ’**: è¯¦ç»†çš„åŠŸèƒ½å›å½’æµ‹è¯•è®¡åˆ’

### é£é™©è¯„ä¼°
- **ğŸ”´ é«˜é£é™©**: åŠŸèƒ½å›å½’ï¼Œéœ€è¦å……åˆ†æµ‹è¯•
- **ğŸŸ¡ ä¸­é£é™©**: æ€§èƒ½å½±å“ï¼Œéœ€è¦æ€§èƒ½ç›‘æ§
- **ğŸŸ¢ ä½é£é™©**: å¼€å‘æ•ˆç‡ï¼Œé€šè¿‡åŸ¹è®­è§£å†³

### èµ„æºéœ€æ±‚
- **ğŸ‘¨â€ğŸ’» å¼€å‘èµ„æº**: 1-2åå¼€å‘è€…ï¼Œ4å‘¨æ—¶é—´
- **ğŸ§ª æµ‹è¯•èµ„æº**: å…¨é¢çš„åŠŸèƒ½å’Œæ€§èƒ½æµ‹è¯•
- **ğŸ“š æ–‡æ¡£èµ„æº**: æ›´æ–°å¼€å‘æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—

---

**ğŸ“ å¤‡æ³¨**: æ­¤è®¡åˆ’ä¸ºåŠ¨æ€æ–‡æ¡£ï¼Œå°†æ ¹æ®å®é™…æ‰§è¡Œæƒ…å†µè¿›è¡Œè°ƒæ•´å’Œä¼˜åŒ–ã€‚

**ğŸ“… åˆ›å»ºæ—¶é—´**: 2025å¹´7æœˆ20æ—¥  
**ğŸ“… æœ€åæ›´æ–°**: 2025å¹´7æœˆ20æ—¥  
**ğŸ‘¤ è´Ÿè´£äºº**: å¼€å‘å›¢é˜Ÿ  
**ğŸ“Š å½“å‰çŠ¶æ€**: è®¡åˆ’é˜¶æ®µ