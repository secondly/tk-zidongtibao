# 🔄 三层嵌套循环自动化配置指南

## 📋 功能概述

三层嵌套循环功能专门用于处理复杂的多层弹窗操作流程，特别适用于以下场景：
- 主页面列表 → 第一个弹窗 → 第二个弹窗 → 返回主页面
- 每个主列表项都需要完成完整的弹窗操作流程
- 需要在第二个弹窗中进行区间选择操作

## 🎯 测试页面说明

测试页面：`triple-nested-loop-demo.html`

### 页面结构：
1. **主页面列表**：包含5个数据项目，每个都有"测试按钮"
2. **第一个弹窗**：点击测试按钮后异步加载，包含"选择类目按钮"
3. **第二个弹窗**：点击选择类目按钮后异步加载，包含多选列表和"确定按钮"

## ⚙️ 配置步骤

### 第一步：创建嵌套循环步骤

1. 打开插件弹窗
2. 点击"新建"创建工作流
3. 点击"🔄🔄🔄 嵌套循环"工具按钮
4. 在弹出的编辑框中进行配置

### 第二步：主循环配置

```
主循环定位策略：CSS选择器
主循环定位值：.test-btn
```

**说明：**定位主页面列表中的所有"测试按钮"

### 第三步：第一个弹窗配置

```
第一个弹窗等待定位值：#firstModal .modal-content
第一个弹窗操作定位值：#selectCategoryBtn
```

**说明：**
- 等待第一个弹窗加载完成
- 点击弹窗中的"选择类目按钮"

### 第四步：第二个弹窗配置

```
第二个弹窗等待定位值：#secondModal .selection-list
区间选择定位值：#secondModalBody input[type="checkbox"]
区间起始索引：2
区间结束索引：6
确认按钮定位值：#confirmBtn
```

**说明：**
- 等待第二个弹窗的选择列表加载完成
- 自动勾选索引2-6的复选框（对应选项3-7）
- 点击确认按钮完成选择

### 第五步：时间配置

```
主循环间隔：1000毫秒
返回等待时间：1000毫秒
```

**说明：**
- 主循环间隔：处理完一个主列表项后等待的时间
- 返回等待时间：完成所有弹窗操作后等待返回主页面的时间

## 🚀 完整配置示例

### 嵌套循环步骤配置：

| 配置项 | 值 | 说明 |
|--------|-----|------|
| 步骤名称 | 三层嵌套循环测试 | 自定义名称 |
| 主循环定位策略 | CSS选择器 | 定位策略 |
| 主循环定位值 | `.test-btn` | 主页面测试按钮 |
| 第一个弹窗等待定位值 | `#firstModal .modal-content` | 等待第一个弹窗 |
| 第一个弹窗操作定位值 | `#selectCategoryBtn` | 选择类目按钮 |
| 第二个弹窗等待定位值 | `#secondModal .selection-list` | 等待选择列表 |
| 区间选择定位值 | `#secondModalBody input[type="checkbox"]` | 复选框列表 |
| 区间起始索引 | `2` | 从第3个选项开始 |
| 区间结束索引 | `6` | 到第7个选项结束 |
| 确认按钮定位值 | `#confirmBtn` | 确定按钮 |
| 主循环间隔 | `1000` | 1秒间隔 |
| 返回等待时间 | `1000` | 1秒等待 |

## 🔧 执行流程

### 自动化执行顺序：

1. **主循环开始**：找到所有`.test-btn`元素
2. **第一层循环**：依次点击每个测试按钮
3. **智能等待**：等待第一个弹窗（`#firstModal .modal-content`）出现
4. **第二层操作**：点击选择类目按钮（`#selectCategoryBtn`）
5. **智能等待**：等待第二个弹窗（`#secondModal .selection-list`）出现
6. **第三层操作**：勾选索引2-6的复选框
7. **确认操作**：点击确定按钮（`#confirmBtn`）
8. **返回等待**：等待返回主页面
9. **循环继续**：处理下一个主列表项

## 📊 预期结果

### 成功执行后：
- ✅ 所有5个数据项目都被处理
- ✅ 每个项目的状态变为"已完成"
- ✅ 每个项目都完成了完整的弹窗流程
- ✅ 在第二个弹窗中正确选择了索引2-6的选项
- ✅ 显示执行进度和完成统计

### 进度显示：
```
自动化进度：1/5 项已完成 (20.0%)
自动化进度：2/5 项已完成 (40.0%)
自动化进度：3/5 项已完成 (60.0%)
自动化进度：4/5 项已完成 (80.0%)
自动化进度：5/5 项已完成 (100.0%)
🎉 所有项目处理完成！三层嵌套循环测试成功！
```

## ⚠️ 注意事项

### 重要提醒：
1. **智能等待**：每个弹窗都有异步加载时间，系统会自动等待元素出现
2. **错误处理**：如果某个弹窗加载失败，会自动跳过并继续下一个
3. **元素定位**：确保所有定位值都正确，可以使用浏览器开发者工具验证
4. **时间配置**：根据实际页面加载速度调整等待时间
5. **测试建议**：先在测试页面验证配置，再应用到实际场景

### 故障排除：
- **弹窗未出现**：检查等待定位值是否正确
- **按钮点击失败**：确认按钮定位值和可见性
- **选择失败**：验证复选框定位值和索引范围
- **返回异常**：调整返回等待时间

## 🎊 扩展应用

这个三层嵌套循环模式可以应用于：
- 电商平台的批量商品管理
- CRM系统的客户信息批量处理
- 内容管理系统的批量审核流程
- 数据录入系统的批量操作
- 任何需要多层弹窗交互的业务场景

通过合理配置定位值和时间参数，可以适应各种复杂的自动化需求！
